<!DOCTYPE chapter>
<chapter xmlns="http://docbook.org/ns/docbook" version="5.0" xml:id="isql" xml:lang="ru">
    <info>
        <title>Интерактивные запросы</title>
    </info>

    <para>В этой главе содержится описапние консольной утилиты Firebird Interactive SQL Utility
            (<application>isql</application>) и инструкции по его использованию для выполнения задач
        в базе данных.</para>

    <para>Утилита ISQL расположена в корневом каталоге установки Firebird. Она предоставляет
        интерфейс командной строки для интерактивного доступа к базе данных Firebird. ISQL принимает
        операторы DSQL вместе с группой команд SET и SHOW для запросов и взаимодействия с базой
        данных Firebird. Некоторые команды SET могут быть включены в сценарии DDL для выполнения
        пакетных операций в isql. Она также обрабатывает команды DDL, DML и консоли.</para>

    <para>Утилита isql может использоваться в трех режимах: в качестве интерактивного сеанса; прямо
        из командной строки; и как неинтерактивный сеанс, используя сценарий оболочки или пакетный
        файл. В каждом из режимов могут выполняться разные задачи, как показано ниже: <itemizedlist>
            <listitem>
                <para>В интерактивном режиме пользователь последовательно вводит команды для работы
                    с базами данных и тут же получает результат их выполнения. При этом одна команда
                    может быть разбита на несколько строк. После завершения обработки каждой команды
                    и вывода всех результатов её работы пользователь получает приглашение ввести
                    следующую команду до тех пор, пока не будет введена команда выхода из
                    интерактивного режима QUIT или EXIT. Isql можно использовать в интерактивном
                    режиме для:<itemizedlist spacing="compact">
                        <listitem>
                            <para>Создания, редактирования, удаления или просмотра данных и
                                метаданных;</para>
                        </listitem>
                        <listitem>
                            <para>Ввода файла сценария содержащего пакет SQL запросов;</para>
                        </listitem>
                        <listitem>
                            <para>Добавлять и модифицировать данные;</para>
                        </listitem>
                        <listitem>
                            <para>Предоставлять разрешение пользователю и отбирать их;</para>
                        </listitem>
                        <listitem>
                            <para>Управлять учётными записями;</para>
                        </listitem>
                        <listitem>
                            <para>Выполнять административные функции базы данных.</para>
                        </listitem>
                    </itemizedlist></para>
            </listitem>
            <listitem>
                <para>Непосредственно из командной строки, с отдельными параметрами и без запуска
                    интерактивного сеанса. Команды выполняются и по завершении возвращают управление
                    автоматически операционной системе.</para>
            </listitem>
            <listitem>
                <para>В неинтерактивном сеансе пользователь использует сценарий оболочки или
                    пакетный файл для выполнения функций базы данных.</para>
            </listitem>
        </itemizedlist></para>

    <note>
        <para>Поскольку другие приложения в среде Linux, например mySQL, также используют isql в
            качестве имени утилиты, рекомендуется запускать утилиту Firebird из ее собственного
            каталога или указывать абсолютный путь к файлу, если у вас есть другая реляционная база
            данных, кроме Firebird, установленная на вашей машине.</para>
    </note>

    <note>
        <para>Некоторые из затронутых дистрибутивов, такие как Mint Linux — на основе Ubuntu —
            переименовали Firebird в isql в isql-fb. Аналогичные изменения могут быть и в других
            дистрибутивах.</para>

        <para>Кроме того, не все дистрибутивы устанавливают Firebird в одно и то же место. Например,
            OpenSuse устанавливает практически все в <filename>/opt/firebird/3.0</filename>, но
            Ubuntu и его производные устанавливают его в различные места, но утилиты находятся в
                <filename>/usr/bin</filename>.</para>

        <para>Далее предполагается что утилита называется isql.</para>
    </note>

    <section xml:id="isql-invoking">
        <title>Запуск isql</title>

        <para>Перейдите в корневой каталог установки сервера Firebird и введите в командной строке
                <filename>isql</filename> (Windows) или <filename>./isql</filename> (Linux). Если
            каталог с isql добавлен в PATH, то нет необходимости переходить в него. </para>
        <para>Синтаксис запуска isql следующий:
            <programlisting>
isql [<replaceable>&lt;options&gt;</replaceable>] [<replaceable>&lt;database&gt;</replaceable>]  
                
<replaceable>&lt;database&gt;</replaceable> ::= [<replaceable>&lt;server spec&gt;</replaceable>] {<replaceable>&lt;db_filename&gt;</replaceable> | <replaceable>&lt;db_alias&gt;</replaceable>}  
                
<replaceable>&lt;server spec&gt;</replaceable> ::= 
    <replaceable>&lt;host&gt;</replaceable>[\{<replaceable>&lt;port&gt;</replaceable> | <replaceable>&lt;service&gt;</replaceable>}]:       
  | \\<replaceable>&lt;host&gt;</replaceable>[@{<replaceable>&lt;port&gt;</replaceable> | <replaceable>&lt;service&gt;</replaceable>}]\     
  | <replaceable>&lt;protocol&gt;</replaceable>://[<replaceable>&lt;host&gt;</replaceable>[:{<replaceable>&lt;port&gt;</replaceable> | <replaceable>&lt;service&gt;</replaceable>}]/]  
                
<replaceable>&lt;protocol&gt;</replaceable> ::= inet | inet4 | inet6 | wnet | xnet                
        </programlisting>
        </para>
        <para>Если параметры <replaceable>&lt;options&gt;</replaceable> не указаны,
                <application>isql</application> запускает интерактивный сеанс. Если база данных не
            указана, то необходимо подключиться к существующей базе данных или создать новую. Если
            база данных была указана, <application>isql</application> запускает интерактивный сеанс,
            подключаясь к указанной базе данных.</para>

        <para>Если указаны параметры, <application>isql</application> запускается в интерактивном
            или не интерактивном режиме, в зависимости от параметров. Например, чтение входного
            файла и запись в выходной файл являются не интерактивными задачами, поэтому параметры
            -input или -output не запускают интерактивный сеанс. Дополнительные не интерактивные
            параметры включают -a, -database, -extract и -x, которые используются при извлечении
            операторов DDL.</para>

        <para>Когда вы запускаете интерактивный сеанс isql, появляется следующее приглашение:
            <screen>
SQL>            
        </screen>
        </para>

        <para>Вы должны завершить каждую команду символом-терминатором. Терминатором по умолчанию
            является точка с запятой (;). Вы можете изменить терминатор на любой символ или группу
            символов с помощью команды SET TERMINATOR или с помощью параметра командной строки
            -terminator. Если вы опустите терминатор, появится приглашение для продолжения ввода
            (CON>).</para>

        <para>Ниже приведен самый простой способ запуска isql. После перехода в интерактивный режим
            вы должны начать с создания новой базы данных или подключения к ней. Сообщение, выданное
            isql, является подсказкой относительно того, что вы должны делать дальше. <programlisting>
<![CDATA[            
c:\Firebird\3.0>isql

Use CONNECT or CREATE DATABASE to specify a database
SQL> CONNECT "inet://localhost:3053/employee"
CON> user "SYSDBA" password 'masterkey';
Database: "inet://localhost:3053/employee", User: SYSDBA
SQL>    
]]>
        </programlisting>
        </para>

        <para>В следующем примере показано, как передать имя базы данных и учетные данные
            пользователя в командной строке. <programlisting>
<![CDATA[            
c:\Firebird\3.0>isql -user sysdba -password masterkey "inet://localhost:3053/employee"

Database: inet://localhost:3053/employee, User: SYSDBA
SQL>
]]>
        </programlisting>
        </para>

        <para>В этом примере мы использовали псевдоним для базы данных employee. Этот пример
            предопределен в файле <filename>databases.conf</filename>, который обычно находится в
            каталоге, в котором установлен Firebird, но некоторые дистрибутивы Linux помещают его в
                <filename>/etc/firebird/n.n</filename>, где n.n - версия сервера базы данных
            Firebird. Ниже приведена дополнительная информация о подключении к базам данных с
            использованием полных путей или псевдонимов.</para>
    </section>

    <section xml:id="isql-switches">
        <title>Переключатели командной строки</title>

        <para>Переключатели командной строки — это аргументы, которые начинаются с символа
            минус/дефис (-). Ниже приведен пример того, что происходит, когда вы пытаетесь запустить
            isql с недопустимым переключателем — он отображает список допустимых ключей с кратким
            описанием каждого из них. <programlisting>
<![CDATA[
c:\Firebird\3.0>isql -help
Unknown switch: -help
usage:    isql [options] [<database>]
        -a(ll)                  extract metadata incl. legacy non-SQL tables
        -b(ail)                 bail on errors (set bail on)
        -c(ache) <num>          number of cache buffers
        -ch(arset) <charset>    connection charset (set names)
        -d(atabase) <database>  database name to put in script creation
        -e(cho)                 echo commands (set echo on)
        -ex(tract)              extract metadata
        -f(etch_password)       fetch password from file
        -i(nput) <file>         input file (set input)
        -m(erge)                merge standard error
        -m2                     merge diagnostic
        -n(oautocommit)         no autocommit DDL (set autoddl off)
        -nod(btriggers)         do not run database triggers
        -now(arnings)           do not show warnings
        -o(utput) <file>        output file (set output)
        -pag(elength) <size>    page length
        -p(assword) <password>  connection password
        -q(uiet)                do not show the message "Use CONNECT..."
        -r(ole) <role>          role name
        -r2 <role>              role (uses quoted identifier)
        -s(qldialect) <dialect> SQL dialect (set sql dialect)
        -t(erminator) <term>    command terminator (set term)
        -tr(usted)              use trusted authentication
        -u(ser) <user>          user name
        -x                      extract metadata
        -z                      show program and server version
]]>                        
        </programlisting>
        </para>

        <note>
            <para>Требуются только начальные символы в опции. Вы можете ввести любую часть текста,
                заключенную в скобки, включая полное имя опции. Например, указание -n, -no или
                -noauto имеет тот же эффект.</para>
        </note>

        <para>
            <table frame="topbot">
                <title>Переключатели командной строки</title>
                <tgroup cols="2">
                    <colspec colname="c1" colnum="1" colwidth="0.5*"/>
                    <colspec colname="c2" colnum="2" colwidth="1.4*"/>
                    <thead>
                        <row>
                            <entry>Опции</entry>
                            <entry>Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>-a(ll)</entry>
                            <entry><para>Извлечение всех метаданных, включая не-SQL объекты.
                                    Используется совместно с командой extract</para></entry>
                        </row>
                        <row>
                            <entry>-b(ail)</entry>
                            <entry><para>Этот переключатель указывает утилите передать ошибку в ОС,
                                    но только в пакетном режиме (<code>SET BAIL ON</code>). Он был
                                    добавлен, чтобы предотвратить выполнение сценариев isql после
                                    обнаружения ошибки. Дальнейшие операторы не будут выполняться, и
                                    isql вернет код ошибки в ОС.</para>
                                <para>Пользователям по-прежнему необходимо использовать
                                    переключатель — e(cho) для вывода команд в выходной файл, чтобы
                                    выделить точный оператор, вызвавший ошибку.</para>
                                <para>Когда сервер предоставляет информацию о строках и столбцах,
                                    пользователи могут найти точную строку в DML скрипте, вызвавшую
                                    проблему. Когда сервер указывает только ошибку, то пользователи
                                    могут увидеть только первую строку оператора, вызвавшего сбой по
                                    отношению ко сему сценарию.</para>
                                <para>Эта функция также поддерживается во вложенных скриптах.
                                    Например, сценарий A включает в себя сценарий B, а сценарий B
                                    вызывает ошибку, номер строки связан со сценарием B. Когда
                                    сценарий B полностью прочитан, <application>isql</application>
                                    продолжает считать строки, относящиеся к сценарию A, поскольку
                                    каждый файл получает отдельный счетчик строк. Сценарий A
                                    включает сценарий B, когда сценарий A использует команду
                                        <code>INPUT</code> для загрузки сценария B.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>-c(ache) <replaceable>&lt;num&gt;</replaceable></entry>
                            <entry>Задаёт количество страниц, которые будут кэшированы при
                                соединении с БД.</entry>
                        </row>
                        <row>
                            <entry>-ch(arset) <replaceable>&lt;charset&gt;</replaceable></entry>
                            <entry>Задаёт кодировку для текущего соединения. Это же можно сделать с
                                использовании команды <code>SET NAMES</code></entry>
                        </row>
                        <row>
                            <entry>-d(atabase) <replaceable>&lt;database&gt;</replaceable></entry>
                            <entry><para>Используется совместно с переключателем -x или -ex.
                                    Изменяет оператор CREATE DATABASE, который извлекается в файл:<itemizedlist>
                                        <listitem>
                                            <para>Без переключателя -d оператор CREATE DATABASE
                                                извлекается в скрипт как комментарий в стиле C, и
                                                использует имя базы данных указанное в командной
                                                строке isql</para>
                                        </listitem>
                                        <listitem>
                                            <para>С переключателем -d оператор CREATE DATABASE
                                                извлекается не закомментированным, и подставляет имя
                                                базы данных указанное в переключателе</para>
                                        </listitem>
                                    </itemizedlist></para></entry>
                        </row>
                        <row>
                            <entry>-e(cho) </entry>
                            <entry>Включает дублирование команд на указанное устройство вывода
                                (монитор, в файл, и т. д.) Это можно сделать и с использованием
                                команды <code>SET ECHO ON</code></entry>
                        </row>
                        <row>
                            <entry>-ex(tract)</entry>
                            <entry>Извлечение метаданных из базы данных. Его можно использовать
                                вместе с ключом -o(utput) для извлечения информации в указанный
                                выходной файл.</entry>
                        </row>
                        <row>
                            <entry>-f(etch_password) </entry>
                            <entry>Извлечение пароля из файла</entry>
                        </row>
                        <row>
                            <entry>-i(nput) <replaceable>&lt;file&gt;</replaceable>
                            </entry>
                            <entry>Задаёт файл с SQL-скриптом для выполнения. Файлы скриптов могут
                                содержать команду <code>SET INPUT</code> для включения других
                                файлов.</entry>
                        </row>
                        <row>
                            <entry>-m(erge_stderr) </entry>
                            <entry>Перенаправление ошибок (stderr) на поток стандартного вывода.
                                Ключ командной строки -m(erge) может использоваться для включения
                                сообщений об ошибках в выходные файлы.</entry>
                        </row>
                        <row>
                            <entry>-m2 </entry>
                            <entry>Отправлять информацию о статистике и планах в выходной файл,
                                который указан в переключателе -o(utput). Ключ командной строки -m2
                                гарантирует, что статистика и информация о плане, полученные из
                                команд <code>SET STATS</code>, <code>SET PLAN</code> и <code>SET
                                    PLANONLY</code>, также отправляются в выходной файл, а не просто
                                возвращаются в консоль.</entry>
                        </row>
                        <row>
                            <entry>-n(oautocommit)</entry>
                            <entry>Отключить автоматическое подтверждение DDL-операций. По умолчанию
                                операторы DDL фиксируются автоматически в отдельной транзакции.
                                Может быть изменено командой <code>SET AUTODDL OFF</code></entry>
                        </row>
                        <row>
                            <entry>-nod(btriggers)</entry>
                            <entry>Не запускать триггеры базы данных.</entry>
                        </row>
                        <row>
                            <entry>-now(arnings)</entry>
                            <entry>Не показывать предупреждения.</entry>
                        </row>
                        <row>
                            <entry>-o(utput) <replaceable>&lt;file&gt;</replaceable></entry>
                            <entry>Задаёт файл для вывода результата выполнения запросов. Без
                                аргументов перенаправляет вывод на стандартное устройство вывода
                                (монитор). Может быть изменён так же командой <code>SET
                                    OUTPUT</code></entry>
                        </row>
                        <row>
                            <entry>-pag(elength) <replaceable>&lt;size&gt;</replaceable></entry>
                            <entry>Размер страницы. Печатает заголовки столбцов каждые
                                    <replaceable>&lt;size&gt;</replaceable> строк вместо значений по
                                умолчанию 20.</entry>
                        </row>
                        <row>
                            <entry>-p(assword) <replaceable>&lt;password&gt;</replaceable></entry>
                            <entry>Пароль пользователя при подключении к базе данных.</entry>
                        </row>
                        <row>
                            <entry>-q(uiet)</entry>
                            <entry>Не показывать сообщение "Use CONNECT...".</entry>
                        </row>
                        <row>
                            <entry>-r(ole) <replaceable>&lt;role&gt;</replaceable></entry>
                            <entry>Имя роли при подключении к базе данных.</entry>
                        </row>
                        <row>
                            <entry>-r2 <replaceable>&lt;role&gt;</replaceable></entry>
                            <entry><para>Имя роли (с использованием квотированных идентификаторов).
                                    Этот переключатель можно использовать для указания имени роли с
                                    учетом регистра. </para>
                                <para>По умолчанию для передачи роли используется переключатель
                                    -r(ole). В этом случае роль, представленная в командной строке,
                                    пишется в верхнем регистре. Если используется переключатель -r2,
                                    то роль передаются в движок в точности так, как это указано в
                                    командной строке.</para></entry>
                        </row>
                        <row>
                            <entry>-s(qldialect) <replaceable>&lt;dialect&gt;</replaceable></entry>
                            <entry>Устанавливает SQL диалект к котором интерпретируются последующие
                                команды до конца сеанса или до тех пор, пока диалект не будет
                                изменён с помощью инструкции <code>SET SQL DIALECT</code>.</entry>
                        </row>
                        <row>
                            <entry>-t(erminator) <replaceable>&lt;term&gt;</replaceable></entry>
                            <entry>Изменяет символ конца оператора (терминатора) с точки с запятой
                                    <quote>;</quote> по умолчанию на
                                    <replaceable>&lt;term&gt;</replaceable>, где
                                    <replaceable>&lt;term&gt;</replaceable> — любой символ или
                                последовательность символов. Тоже самое можно сделать использую
                                команду <code>SET TERM</code>.</entry>
                        </row>
                        <row>
                            <entry>-tr(usted)</entry>
                            <entry>Использовать доверительную аутентификацию.</entry>
                        </row>
                        <row>
                            <entry>-u(ser) <replaceable>&lt;user&gt;</replaceable></entry>
                            <entry>Имя пользователя для подключения к базе данных.</entry>
                        </row>
                        <row>
                            <entry>-x</entry>
                            <entry>Извлечение метаданных из базы данных. Его можно использовать
                                вместе с ключом -o(utput) для извлечения информации в указанный
                                выходной файл.</entry>
                        </row>
                        <row>
                            <entry>-z</entry>
                            <entry>Показать версии утилиты и сервера.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>

        <section xml:id="isql-switches-examples">
            <title>Примеры</title>

            <para>
                <example>
                    <title>Выполнение скрипта создания базы данных</title>

                    <para>
                        <programlisting>
isql -input createdb.sql                            
                        </programlisting>
                    </para>
                </example>
                <example>
                    <title>Запуск интерактивного сеанса с подключением к удалённой базе
                        данных</title>

                    <para>В следующем примере начинается интерактивное соединение с удаленной базой
                        данных. Удаленный сервер jupiter, принимает указанную комбинацию
                        пользователя и пароля с привилегиями, назначенными роли STAFF:
                        <programlisting>
isql -user sales -password mycode -role staff 'jupiter:/usr/customer.fdb'                            
                        </programlisting>
                    </para>
                </example>
                <example>
                    <title>Запуск интерактивного сеанса без подключения к базе данных</title>

                    <para>Следующий пример запускает интерактивный сеанс, но не подключается к базе
                        данных. Все введенные команды <application>isql</application> выводятся на
                        печать, а результаты запроса печатают заголовки столбцов каждые 30 строк:
                        <programlisting>
isql -echo -page 30                            
                        </programlisting>
                    </para>
                </example>
            </para>
        </section>
    </section>
    <section xml:id="isql-start_session">
        <title>Начало сессии Isql</title>

        <para>Чтобы начать сеанс <application>isql</application>, введите параметры командной строки
            и имя базы данных в оболочке Linux/Unix или командной консоли Windows. Например:
            <programlisting>
isql [<replaceable>&lt;options&gt;</replaceable>] [<replaceable>&lt;database&gt;</replaceable>]                          
                        </programlisting>
        </para>

        <note>
            <para>При подключении к удаленной базе данных вам нужно будет включить соответствующие
                параметры -user и -password в свои параметры, если только пользователи не объявили
                ISC_USER и ISC_PASSWORD в качестве переменных операционной системы. Например:
                <programlisting>
isql -user SYSDBA -password masterkey inet4://localhost/mydatabase                            
                        </programlisting>
            </para>
            <para>При подключении к локальной базе данных в embedded варианте достаточно указать
                только имя пользователя (пароль будет проигнорирован):
                <programlisting>
isql -user SYSDBA employee.db                           
                        </programlisting>
            </para>
            <para>В Windows вы можете использовать доверительную аутентификацию, при условии что она
                настроена в <filename>firebird.conf</filename> или
                    <filename>databases.conf</filename>:
                <programlisting>
isql -trusted inet4://localhost/mydatabase                            
                        </programlisting>
            </para>
        </note>
        <para>Если параметры <replaceable>&lt;options&gt;</replaceable> не указаны,
                <application>isql</application> запускает интерактивный сеанс. Если база данных не
            указана, то необходимо подключиться к существующей базе данных или создать новую. Если
            база данных была указана, <application>isql</application> запускает интерактивный сеанс,
            подключаясь к указанной базе данных.</para>

        <para>Чтение входного файла и запись в выходной файл не считаются интерактивными задачами,
            поэтому параметры командной строки -input или -output не инициируют интерактивный сеанс.
            Опции, используемые для извлечения операторов DDL, такие как -a и -x, также инициируют
            только неинтерактивный сеанс.</para>

        <para>Isql может быть запущен с локального или удаленного клиента:<itemizedlist>
                <listitem>
                    <para>При подключении с использованием локального клиента вы можете установить
                        переменные среды ISC_USER и ISC_PASSWORD.</para>
                </listitem>
                <listitem>
                    <para>При подключении с удаленного клиента вам потребуется указать
                        действительные имя и пароль.</para>
                </listitem>
            </itemizedlist></para>
    </section>
    <section xml:id="isql-end_session">
        <title>Завершение сессии Isql</title>
        <para>Существует два способа выхода из isql:<itemizedlist>
                <listitem>
                    <para>Если вы хотите откатить всю неподтвержденную работу и выйти из isql,
                        введите в командной строке следующую команду:
                        <programlisting>
SQL> QUIT;                        
                    </programlisting>
                    </para>
                </listitem>
                <listitem>
                    <para>Если вы хотите зафиксировать всю свою работу перед выходом из isql,
                        введите следующую команду:
                        <programlisting>
SQL> EXIT;                      
                    </programlisting>
                    </para>
                </listitem>
            </itemizedlist></para>
    </section>
    <section xml:id="isql-help">
        <title>Получение справки</title>
        <para>Isql поставляется с командой HELP. Это дает краткую информацию о большинстве доступных
            команд. Команда HELP также позволяет перейти к более подробной информации. Чтобы
            активировать справочную систему, просто введите HELP в командной строке, как показано
            ниже: <programlisting>
SQL> HELP;                      
                    </programlisting>
            <screen>
<![CDATA[
Frontend commands:
BLOBDUMP <blobid> <file>   -- dump BLOB to a file
BLOBVIEW <blobid>          -- view BLOB in text editor
EDIT     [<filename>]      -- edit SQL script file and execute
EDIT                       -- edit current command buffer and execute
HELP                       -- display this menu
INput    <filename>        -- take input from the named SQL file
OUTput   [<filename>]      -- write output to named file
OUTput                     -- return output to stdout
SET      <option>          -- (Use HELP SET for complete list)
SHELL    <command>         -- execute Operating System command in sub-shell
SHOW     <object> [<name>] -- display system information
    <object> = CHECK, COLLATION, DATABASE, DOMAIN, EXCEPTION, FILTER, FUNCTION,
               GENERATOR, GRANT, INDEX, PACKAGE, PROCEDURE, ROLE, SQL DIALECT,
               SYSTEM, TABLE, TRIGGER, VERSION, USERS, VIEW
EXIT                       -- exit and commit changes
QUIT                       -- exit and roll back changes

All commands may be abbreviated to letters in CAPitals
]]>                
            </screen>
        </para>
        <para>Большинство из этих команд не имеют дальнейших уровней детализации, в то время как
            команда SET имеет. Чтобы углубиться в эти дополнительные уровни, выполните следующие
            действия: <programlisting>
SQL> HELP SET;                      
                    </programlisting>
            <screen>
<![CDATA[
Set commands:
    SET                    -- display current SET options
    SET AUTOddl            -- toggle autocommit of DDL statements
    SET BAIL               -- toggle bailing out on errors in non-interactive mode
    SET BLOB [ALL|<n>]     -- display BLOBS of subtype <n> or ALL
    SET BLOB               -- turn off BLOB display
    SET COUNT              -- toggle count of selected rows on/off
    SET MAXROWS [<n>]      -- limit select stmt to <n> rows, zero is no limit
    SET ECHO               -- toggle command echo on/off
    SET EXPLAIN            -- toggle display of query access plan in the explained form
    SET HEADING            -- toggle display of query column titles
    SET LIST               -- toggle column or table display format
    SET NAMES <csname>     -- set name of runtime character set
    SET PLAN               -- toggle display of query access plan
    SET PLANONLY           -- toggle display of query plan without executing
    SET SQL DIALECT <n>    -- set sql dialect to <n>
    SET STATs              -- toggle display of performance statistics
    SET TIME               -- toggle display of timestamp with DATE values
    SET TERM <string>      -- change statement terminator string
    SET WIDTH <col> [<n>]  -- set/unset print width to <n> for column <col>

All commands may be abbreviated to letters in CAPitals
]]>                
            </screen>
        </para>
        <para>Если вы попытаетесь углубиться в какую-либо другую команду, эффект будет точно таким
            же, как при выполнении только команды HELP.</para>
        <note>
            <para>Команда HELP SET даёт справку только по собственным командам isql. Для управляющий
                SQL операторов, таких как SET TRANSACTION или SET ROLE подсказка не будет
                выведена.</para>
        </note>
    </section>
    <section xml:id="isql-connect">
        <title>Соединение с базой данных</title>

        <para>Если при запуске isql вы не указали спецификацию для подключения к базе данных, то
            будет выдана подсказка о том что необходимо соединиться с базой данных с помощью
            оператора CONNECT или создать новую базу данных с помощью оператора CREATE
            DATABASE.</para>
        <para>Оператор CONNECT не является частью DSQL и доступен только внутри ISQL, а потому не
            описан в <quote>Руководство по языку SQL Firebird</quote>. Рассмотрим его
            синтаксис.</para>
        <formalpara>
            <title>Синтаксис:</title>
            <para>
                <programlisting> 
CONNECT <replaceable>&lt;database&gt;</replaceable> 
[USER <replaceable>&lt;username&gt;</replaceable> [PASSWORD <replaceable>&lt;password&gt;</replaceable>]]
[CACHE <replaceable>&lt;cache size&gt;</replaceable>] 
[ROLE <replaceable>&lt;rolename&gt;</replaceable>]                    
                    
<replaceable>&lt;database&gt;</replaceable> ::= [<replaceable>&lt;server spec&gt;</replaceable>] {<replaceable>&lt;db_filename&gt;</replaceable> | <replaceable>&lt;db_alias&gt;</replaceable>}  
                
<replaceable>&lt;server spec&gt;</replaceable> ::= 
    <replaceable>&lt;host&gt;</replaceable>[\{<replaceable>&lt;port&gt;</replaceable> | <replaceable>&lt;service&gt;</replaceable>}]:       
  | \\<replaceable>&lt;host&gt;</replaceable>[@{<replaceable>&lt;port&gt;</replaceable> | <replaceable>&lt;service&gt;</replaceable>}]\     
  | <replaceable>&lt;protocol&gt;</replaceable>://[<replaceable>&lt;host&gt;</replaceable>[:{<replaceable>&lt;port&gt;</replaceable> | <replaceable>&lt;service&gt;</replaceable>}]/]  
                
<replaceable>&lt;protocol&gt;</replaceable> ::= inet | inet4 | inet6 | wnet | xnet                         
                    </programlisting>
            </para>
        </formalpara>
        <para>
            <table frame="all">
                <title>Параметры оператора CONNECT</title>
                <?dbfo keep-together='auto'?>
                <tgroup cols="2">
                    <colspec colname="colArgument" colnum="1" colwidth="1.2*" align="left"/>
                    <colspec colname="colDesc" colnum="2" colwidth="2.8*" align="left"/>
                    <thead>
                        <row valign="middle">
                            <entry align="center">Параметр</entry>
                            <entry align="center">Описание</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry><replaceable>database</replaceable></entry>
                            <entry>Спецификация базы данных.</entry>
                        </row>
                        <row>
                            <entry><replaceable>username</replaceable></entry>
                            <entry>Имя пользователя для соединения с базой данных. Может быть
                                заключено в одинарные или двойные кавычки. Если имя пользователя
                                заключено в двойные кавычки, то оно чувствительно к
                                регистру.</entry>
                        </row>
                        <row>
                            <entry><replaceable>password</replaceable></entry>
                            <entry>Пароль пользователя для соединения с базой данных. Чувствительно
                                к регистру. Должен быть заключён в одинарный кавычки.</entry>
                        </row>
                        <row>
                            <entry><replaceable>cache size</replaceable></entry>
                            <entry>Размер страничного кеша.</entry>
                        </row>
                        <row>
                            <entry><replaceable>rolename</replaceable></entry>
                            <entry>Имя роли для соединения с базой данных. Может быть заключено в
                                одинарные или двойные кавычки. Если имя роли заключено в двойные
                                кавычки, то оно чувствительно к регистру.</entry>
                        </row>
                        <row>
                            <entry><replaceable>server spec</replaceable></entry>
                            <entry>Спецификация удалённого сервера. Включает в себя имя сервера и
                                протокол.</entry>
                        </row>
                        <row>
                            <entry><replaceable>db_filename</replaceable></entry>
                            <entry>Полный путь и имя файла базы данных, включая расширение. Имя
                                файла должно быть задано в соответствии со спецификой используемой
                                платформы.</entry>
                        </row>
                        <row>
                            <entry><replaceable>db_alias</replaceable></entry>
                            <entry>Псевдоним (alias) базы данных, присутствующий в файле
                                    <filename>databases.conf</filename></entry>
                        </row>
                        <row>
                            <entry><replaceable>host</replaceable></entry>
                            <entry>Имя сервера или IP адрес, на котором расположена база
                                данных.</entry>
                        </row>
                        <row>
                            <entry><replaceable>port</replaceable></entry>
                            <entry>Номер порта, который слушает удалённый сервер (параметр
                                    <parameter>RemoteServicePort</parameter> файла
                                    <filename>firebird.conf</filename>).</entry>
                        </row>
                        <row>
                            <entry><replaceable>service</replaceable></entry>
                            <entry>Имя сервиса. Должно совпадать со значением параметра
                                    <parameter>RemoteServiceName</parameter> файла
                                    <filename>firebird.conf</filename></entry>
                        </row>
                        <row>
                            <entry><replaceable>protocol</replaceable></entry>
                            <entry>Наименование протокола.</entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </para>
        <para>База данных может состоять из одного или нескольких файлов. Первый, основной, файл
            называется первичным, остальные файлы — вторичными. При подключении к базе данных
            необходимо указывать только путь до первичного файла базы данных.</para>

        <para>Спецификация первичного файла — имя файла базы данных и его расширение с указанием к
            нему полного пути в соответствии с правилами используемой операционной системы. </para>
        <section xml:id="isql-connect-aliasedb">
            <title>Использование псевдонимов БД</title>
            <para>Вместо полного пути к первичному файлу базы можно использовать псевдонимы
                (aliases). Псевдонимы описываются в файле <filename>databases.conf</filename> в
                формате:
                <programlisting>  
<replaceable>alias</replaceable> = <replaceable>filepath</replaceable>                    
                </programlisting>
            </para>
            <note>
                <para>Помимо указания псевдонимов для базы данных в этом файле можно задать
                    параметры уровня базы данных для каждой описываемой базы данных. Эти параметры
                    задаются в фигурных скобках сразу после объявления псевдонима. Подробнее читайте
                    в <link xmlns:xlink="http://www.w3.org/1999/xlink" linkend="config-perdb"
                        >Параметры уровня базы данных</link></para>
            </note>
        </section>
        <section xml:id="isql-connect-remotely">
            <title>Соединение с БД на удалённом сервере</title>
            <para>При соединении с базой данных на удалённом сервере необходимо указать спецификацию
                удалённого сервера. Спецификация удалённого сервера зависит от используемого
                протокола. </para>
            <para>Если вы при соединении с базой данных используете протокол TCP/IP, то спецификация
                первичного файла должна выглядеть следующим образом:
                <programlisting>  
<replaceable>host</replaceable>[/<replaceable>port</replaceable> | <replaceable>service</replaceable>]:{<replaceable>filepath</replaceable> | <replaceable>db_alias</replaceable>}                   
                </programlisting>
            </para>
            <para>Если вы при соединении с базой данных используете протокол под названием
                именованные каналы (Name Pipes), то спецификация первичного файла должна выглядеть
                следующим образом.
                <programlisting>  
\\<replaceable>host</replaceable>[@<replaceable>port</replaceable> | <replaceable>service</replaceable>]\{<replaceable>filepath</replaceable> | <replaceable>db_alias</replaceable>}                   
                </programlisting>
            </para>
            <para>Существует также унифицированный URL-подобный синтаксис спецификации удалённого
                сервера. В этом синтаксисе первым параметром указывается наименование протокола,
                далее указывается имя сервера или IP адрес, номер порта и путь к первичному файлу
                базы данных или псевдоним. В качестве протокола можно указать следующие значения:<itemizedlist>
                    <listitem>
                        <para>INET — TCP/IP (сначала пробует подключится по протоколу TCP/IP v6,
                            если не получилось, то TCP/IP v4);</para>
                    </listitem>
                    <listitem>
                        <para>INET4 — TCP/IP v4 (начиная с 3.0.1);</para>
                    </listitem>
                    <listitem>
                        <para>INET6 — TCP/IP v6 (начиная с 3.0.1);</para>
                    </listitem>
                    <listitem>
                        <para>WNET — NetBEUI или протокол именованных каналов;</para>
                    </listitem>
                    <listitem>
                        <para>XNET — локальный протокол.</para>
                    </listitem>
                </itemizedlist>
                <programlisting>  
<replaceable>protocol</replaceable>://[<replaceable>host</replaceable>[:<replaceable>port</replaceable> | <replaceable>service</replaceable>]/]{<replaceable>filepath</replaceable> | <replaceable>db_alias</replaceable>}                   
                </programlisting>
            </para>
        </section>
        <section xml:id="isql-connect-user">
            <title>Имя пользователя, пароль и роль</title>

            <para>Необязательные предложения <database>USER</database> и
                    <database>PASSWORD</database> задают, соответственно, имя и пароль пользователя
                присутствующего в базе данных безопасности (<filename>security3.fdb</filename> или
                той, что указана в параметре <parameter>SecurityDatabase</parameter>). Пользователя
                и пароль можно не указывать, если установлены переменные окружения
                    <envar>ISC_USER</envar> и <envar>ISC_PASSWORD</envar>. Их также можно не
                указывать при использовании доверительной аутентификации.</para>

            <para>Если подключение происходит к embedded версии сервера, то достаточно указать
                только имя пользователя (проверка пароля не производится).</para>

            <para>Необязательное предложение ROLE задаёт имя роли, права которой будут учитываться
                при подключении базы данных. Роль должна быть назначена пользователю в
                соответствующей базе данных безопасности. </para>
        </section>
        <section xml:id="isql-connect-charset">
            <title>Набор символов</title>

            <para>Команда CONNECT не позволяет указать набор символов для подключения, однако вы
                можете это сделать с помощью команды SET NAMES, которую необходимо ввести до
                использования CONNECT.</para>
        </section>
        <section xml:id="isql-connect-examples">
            <title>Примеры</title>

            <example>
                <title>Подключение к локальной (embedded) базе данных</title>

                <para>В следующем примере происходит подключение к базе данных в embedded варианте с
                    использованием имени пользователя из переменной среды <envar>ISC_USER</envar>.
                    <programlisting>
SQL> CONNECT "C:\DATABASES\FIREBIRD\MY_EMPLOYEE.FDB";                    
                </programlisting>
                </para>
                <para>В Linux это будет выглядеть следующим образом:
                    <programlisting>
SQL> CONNECT "/databases/firebird/MY_EMPLOYEE.FDB";                  
                </programlisting>
                </para>
                <para>При использовании псевдонимов, настроенных в
                        <filename>databases.conf</filename>:
                    <programlisting>
SQL> CONNECT MY_EMPLOYEE;                  
                </programlisting>
                </para>
                <para>Если переменная окружения <envar>ISC_USER</envar> не задана, или требуется
                    указать другого пользователя, то необходимо использовать предложение USER:
                    <programlisting>
SQL> CONNECT MY_EMPLOYEE USER SYSDBA;                  
                </programlisting>                
                </para>
            </example>
            <example>
                <title>Подключение к локальной (не embedded) базе данных</title>
                
                <para/>
            </example>
            <example>
                <title>Подключение к удалённой базе данных</title>
                
                <para></para>
            </example>
        </section>
    </section>
</chapter>
